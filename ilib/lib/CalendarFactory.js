var ilib=require("./ilib.js");var Locale=require("./Locale.js");var LocaleInfo=require("./LocaleInfo.js");var Calendar=require("./Calendar.js");var CalendarFactory=function(options){var locale,type,sync=true,instance;if(options){if(options.locale){locale=typeof options.locale==="string"?new Locale(options.locale):options.locale}type=options.type||options.calendar;if(typeof options.sync==="boolean"){sync=options.sync}}if(!locale){locale=new Locale();}if(!type){new LocaleInfo(locale,{sync:sync,loadParams:options&&options.loadParams,onLoad:ilib.bind(this,function(info){type=info.getCalendar();instance=CalendarFactory._init(type,options);if(options&&typeof options.onLoad==="function"){options.onLoad(instance)}})})}else{instance=CalendarFactory._init(type,options)}return instance};CalendarFactory._dynMap={coptic:"Coptic",ethiopic:"Ethiopic",gregorian:"Gregorian",han:"Han",hebrew:"Hebrew",islamic:"Islamic",julian:"Julian",persian:"Persian","persian-algo":"PersianAlgo",thaisolar:"ThaiSolar"};CalendarFactory._dynLoadCalendar=function(name){if(!Calendar._constructors[name]){var entry=CalendarFactory._dynMap[name];if(entry){Calendar._constructors[name]=require("./"+entry+"Cal.js")}}return Calendar._constructors[name]};CalendarFactory._init=function(type,options){var cons;if(ilib.isDynCode()){CalendarFactory._dynLoadCalendar(type)}cons=Calendar._constructors[type];return cons&&new cons(options)};CalendarFactory.getCalendars=function(){var arr=[],c;if(ilib.isDynCode()){for(c in CalendarFactory._dynMap){CalendarFactory._dynLoadCalendar(c)}}for(c in Calendar._constructors){if(c&&Calendar._constructors[c]){arr.push(c)}}return arr};module.exports=CalendarFactory;
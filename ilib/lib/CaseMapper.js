var ilib=require("./ilib.js");var Locale=require("./Locale.js");var IString=require("./IString.js");var CaseMapper=function(options){this.up=true;this.locale=new Locale();if(options){if(typeof options.locale!=="undefined"){this.locale=typeof options.locale==="string"?new Locale(options.locale):options.locale}this.up=!options.direction||options.direction==="toupper"}this.mapData=this.up?{"ß":"SS","ΐ":"Ι","ά":"Α","έ":"Ε","ή":"Η","ί":"Ι","ΰ":"Υ","ϊ":"Ι","ϋ":"Υ","ό":"Ο","ύ":"Υ","ώ":"Ω","Ӏ":"Ӏ","ӏ":"Ӏ"}:{"Ӏ":"Ӏ"};switch(this.locale.getLanguage()){case"az":case"tr":case"crh":case"kk":case"krc":case"tt":var lower="iı";var upper="İI";this._setUpMap(lower,upper);break;case"fr":if(this.up&&this.locale.getRegion()!=="CA"){this._setUpMap("àáâãäçèéêëìíîïñòóôöùúûü","AAAAACEEEEIIIINOOOOUUUU")}break}if(ilib._getBrowser()==="ie"){if(this.up){this.mapData["ς"]="Σ"}this._setUpMap("ⲁⲃⲅⲇⲉⲋⲍⲏⲑⲓⲕⲗⲙⲛⲝⲟⲡⲣⲥⲧⲩⲫⲭⲯⲱⳁⳉⳋ","ⲀⲂⲄⲆⲈⲊⲌⲎⲐⲒⲔⲖⲘⲚⲜⲞⲠⲢⲤⲦⲨⲪⲬⲮⲰⳀⳈⳊ");this._setUpMap("ⴀⴁⴂⴃⴄⴅⴆⴇⴈⴉⴊⴋⴌⴍⴎⴏⴐⴑⴒⴓⴔⴕⴖⴗⴘⴙⴚⴛⴜⴝⴞⴟⴠⴡⴢⴣⴤⴥ","ႠႡႢႣႤႥႦႧႨႩႪႫႬႭႮႯႰႱႲႳႴႵႶႷႸႹႺႻႼႽႾႿჀჁჂჃჄჅ")}};CaseMapper.prototype={_charMapper:function(string){if(!string){return string}var input=typeof string==="string"?new IString(string):string.toString();var ret="";var it=input.charIterator();var c;while(it.hasNext()){c=it.next();if(!this.up&&c==="Σ"){if(it.hasNext()){c=it.next();var code=c.charCodeAt(0);ret+=code<904&&code!==902||code>974?"ς":"σ";ret+=c.toLowerCase()}else{ret+="ς"}}else{if(this.mapData[c]){ret+=this.mapData[c]}else{ret+=this.up?c.toUpperCase():c.toLowerCase()}}}return ret},_setUpMap:function(lower,upper){var from,to;if(this.up){from=lower;to=upper}else{from=upper;to=lower}for(var i=0;i<upper.length;i++){this.mapData[from[i]]=to[i]}},getLocale:function(){return this.locale},map:function(string){return this._charMapper(string)}};module.exports=CaseMapper;